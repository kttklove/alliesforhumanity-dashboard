<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Business of Homelessness — Marion County</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <style>
    :root { --bg:#fff; --text:#111; --muted:#555; --accent:#0e7c86; --card:#f7f7f9; --shadow:0 2px 10px rgba(0,0,0,.08); --radius:16px; }
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,Noto Sans,sans-serif;line-height:1.45}
    .wrap{max-width:1100px;margin:0 auto;padding:20px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
    .span-12{grid-column:span 12}.span-8{grid-column:span 8}.span-6{grid-column:span 6}.span-4{grid-column:span 4}.span-3{grid-column:span 3}
    @media (max-width:920px){.span-8,.span-6{grid-column:span 12}.span-4,.span-3{grid-column:span 6}}
    @media (max-width:640px){.span-4,.span-3{grid-column:span 12}}
    h1{margin:4px 0 0} h2{margin:0 0 10px} h3{margin:0 0 6px;color:var(--muted);font-size:15px}
    .small{font-size:12px;color:var(--muted)} .row{display:flex;gap:10px;align-items:baseline;flex-wrap:wrap}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#eef8f9;border:1px solid #c8ecef;color:var(--accent);font-size:12px}
    .pending{display:inline-block;padding:2px 8px;border-radius:999px;background:#fff8e1;color:#8a5a00;font-size:12px;border:1px solid #ffda6a}
    .btnbar{display:flex;gap:6px;flex-wrap:wrap}
    button.tab{background:#fff;border:1px solid #d8d8d8;border-radius:10px;padding:6px 10px;cursor:pointer;font-size:12px}
    button.tab:hover{border-color:#bbb} button.tab.active{background:#eef8f9;border-color:#c8ecef;color:var(--accent)}
    .kpi{font-size:28px;font-weight:600}
    .divider{height:1px;background:#e8e8e8;margin:10px 0 12px}
    label {font-size:13px;color:#333}
    input[type=range]{width:100%}
  </style>
</head>
<body>
  <header class="wrap">
    <h1>Business of Homelessness – Marion County</h1>
    <p class="small">Crisis costs (ED, jail, shelter) vs solutions (RRH, PSH). Sources linked under each chart.</p>
  </header>
  <main class="wrap" id="app" aria-live="polite">
    <section class="grid">
      <div class="card span-8" id="shelter-costs-card">
        <h2>Cost per night of shelter (USD)</h2>
        <canvas id="chartShelterCosts"></canvas>
        <div id="shelterCostsPending" class="small"></div>
        <div class="small" id="shelterCostsSource"></div>
      </div>

      <div class="card span-4">
        <h2>Contracts and funding</h2>
        <div id="contractsStats" class="row"></div>
        <div class="divider"></div>
        <canvas id="chartContracts"></canvas>
        <div class="small" id="contractsSource"></div>
      </div>

      <div class="card span-12">
        <h2>Emergency department facility fee — typical moderate visit <span class="small">(CPT 99284)</span></h2>
        <div class="small">Click a hospital to view payer rates. “CPT 99284” = moderate complexity ED visit (treat-and-release).</div>
        <div class="btnbar" id="edTabs" role="tablist" aria-label="Hospital selector"></div>
        <canvas id="chartED"></canvas>
        <div class="small" id="edPending"></div>
        <div class="small" id="edSource"></div>
      </div>

      <div class="card span-12">
        <h2>Crisis costs vs Housing (per person, annual)</h2>
        <div class="grid">
          <div class="span-6">
            <label for="edVisits">ED treat-and-release visits per year</label>
            <input id="edVisits" type="range" min="0" max="24" step="1" value="6" />
            <div class="row"><div><span class="kpi" id="edVisitsCount">6</span> <span class="small">visits</span></div><div><span class="kpi" id="edTotal">$0</span> <span class="small">ED total</span></div></div>
          </div>
          <div class="span-6">
            <label for="jailNights">Nights in jail per year</label>
            <input id="jailNights" type="range" min="0" max="60" step="1" value="10" />
            <div class="row"><div><span class="kpi" id="jailNightsCount">10</span> <span class="small">nights</span></div><div><span class="kpi" id="jailTotal">$0</span> <span class="small">Jail total<span id="jailRangeNote" class="small"></span></span></div></div>
          </div>
        </div>
        <div class="divider"></div>
        <canvas id="chartCompare"></canvas>
        <div class="small" id="compareSource"></div>
      </div>

      <div class="card span-12">
        <h2>Findings from the literature</h2>
        <div id="findings"></div>
      </div>

      <div class="card span-12">
        <h2>Data status</h2>
        <div id="status"></div>
      </div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script src="app.es5.js"></script>
</body>
</html>
